function GenericShimuraCurve237()
  K<t, x> := PolynomialRing(QQ, 2);
  f := t*((t - 27/16)*x^10 - 567/64*x^9 - 189/4*t*x^8 + (-84*t^2 - 189/4*t)*x^7 - 189*t^2*x^6 - 189/2*t^2*x^5 + 84*t^3*x^4 + 108*t^3*x^3 - 28*t^4*x);
  return f;
end function;

function GenericShimuraCurve239()
  S<t, X, Y, Z, T> := PolynomialRing(QQ, 5);
  Q := X*Z - Y^2;
  E := 3*T^3 + t*(t - 1)*(3*T*(5*X^2 + 6*X*Y + 2*t*Y*Z + 3*t*Z^2) + (-2*t + 9)*X^3 + 22*t*X^2*Y + 21*t*X^2*Z + (-14*t^2 + 18*t)*X*Y*Z + t^2*X*Z^2 + 6*t^2*Y*Z^2 + (-3*t^3 + 6*t^2)*Z^3);
  return Q, E;
end function;

function GetShimuraCurve237(param)
  f := GenericShimuraCurve237();
  S<x> := PolynomialRing(Parent(param));
  return Evaluate(f, [param, x]);
end function;

function GetShimuraCurve239(param)
  Q, E := GenericShimuraCurve239();
  S<X, Y, Z, T> := PolynomialRing(Parent(param), 4);
  return Evaluate(Q, [param, X, Y, Z, T]), Evaluate(E, [param, X, Y, Z, T]);
end function;

// Shimura curves
function IsOnShimura237(f : epsilon := Precision(BaseRing(Parent(f))) div 2)
    invs_f, wgt := InvariantsGenus4Curves(f);
    wgt_even := [w : w in wgt | w mod 2 eq 0];
    invs_even := [inv : i->inv in invs_f | wgt[i] mod 2 eq 0]; 
    invs_norm := Normalize(invs_even, wgt_even);
    mu := invs_norm[4];
    invs_shim := 
    [0,
    0,
    8/225*mu,
    mu,
    9555/1552661*mu,
    -136/7425*mu,
    -136/7425*mu,
    22321/1111320*mu,
    41905/373527*mu,
    -1088/121275*mu,
    32453/271656*mu,
    9378917/16180819200*mu,
    -80580799/82771113600*mu,
    3965075087/373776923520*mu,
    -10106041/343429632000*mu,
    6679079/135136512000*mu,
    8415/33575584*mu,
    6432239/92989769600*mu,
    2964307/10679340672*mu,
    799098587/649689064113375*mu^2,
    -35403551/965268798243750*mu^2,
    -737872919/3467287952689275*mu^2,
    104367704/1449535097278125*mu^2 - 27781896571/2628148399027200*mu,
    202166944/543307229053875*mu^2 - 47535787/533045971584*mu,
    24971192/1353269001459375*mu^2 - 1527999253/419581586511360*mu,
    -13955952/19843977993125*mu^2 + 82387485713/827109665907840*mu,
    -33747224/55202338780875*mu^2 - 6182478247/708951142206720*mu,
    45834047/222225660421875*mu^2 - 38197116529/1618258041993600*mu,
    88783492/83293469758125*mu^2 - 91289913/875248323712*mu,
    -112232344/6243925288535*mu^2 + 8403525/51353855728*mu,
    59920516/113310063813375*mu^2 - 146795/4506427296*mu,
    -61538022538343/300181687280798400000*mu^2 + 21026458789611847/4307290703943769350144*mu,
    419176166767579/550333093348130400000*mu^2 - 2817979013040763/89735222998828528128*mu,
    17360603883629/83274086493467100000*mu^2 + 1125455259401629/27156712223329686144*mu,
    92179526694239/150090843640399200000*mu^2 - 52350137286370495/2153645351971884675072*mu,
    1397787163426537/1284110551145637600000*mu^2 - 8124306944780585/209382186997266565632*mu,
    1918564676253251/22623693164729506080000*mu^2 - 57104093245637555/11934784658844194241024*mu,
    36255126482249/431511175466147700000*mu^2 + 88287259051679129/24766921547676673763328*mu,
    1096637001599/35086171240612800000*mu^2 + 402739710504703/1926241805490381324288*mu,
    -5117181688447/64324647274456800000*mu^2 - 53975425119187/40130037614382944256*mu,
    -20211972884261/126533352204359100000*mu^2 + 21556912169221/12144616646457996288*mu,
    -15266198370251/228060113063983200000*mu^2 - 1002711837811255/963120902745190662144*mu,
    -19578822922741/150090843640399200000*mu^2 - 155612557479665/93636754433560203264*mu,
    -9230069858983/327836412529475850000*mu^2 + 1691049620266721/11075890381569692614656*mu,
    169805623/20391829387776000*mu^2,
    -89401/105931581235200*mu^2,
    237610238567/1567601492355892224000*mu^2,
    -1524484215210463/6342919314726500352000*mu^2,
    -7661196259085981/74138017964335718400000*mu^2,
    -7753465235717563/14684835500764910910000000*mu^3 + 960201643633802107/1494684528918996602880000*mu^2];
    RealField(10)!Max([Abs(invs_shim[i]-invs_norm[i]) : i in [1..#invs_shim]]);
    return Max([Abs(invs_shim[i]-invs_norm[i]) : i in [1..#invs_shim]]) lt epsilon;
end function;


function IsOnShimura239(Q, E : epsilon := Precision(BaseRing(Parent(Q))) div 2)
    invs, wgt := InvariantsGenus4Curves(Q, E);
    wgt_even := [w : w in wgt | w mod 2 eq 0];
    invs_even := [inv : i->inv in invs | wgt[i] mod 2 eq 0]; 
    invs_norm := WPSMultiply([w div 2 : w in wgt_even], invs_even, invs[6]/invs[1]);
    a := invs[7]/invs[1];
    t := (918*a-3645)/(22*a+675);
    //invs_norm := WPSMultiply([w div 2 : w in wgt_even], invs_norm, t - 459/11);
    invs_shim := [27993600/121*t/(t^2 - 918/11*t + 210681/121),
    (1285255879616102400/1771561*t^4 - 20727258712060723200/1771561*t^3 + 47773803616822886400/1771561*t^2)/(t^6 - 2754/11*t^5 + 3160215/121*t^4 - 1934051580/1331*t^3 + 665797256415/14641*t^2 - 122240376277794/161051*t + 9351388785251241/1771561),
    (-1057780806353666929852416000/2357947691*t^7 - 69036562852747652578148352000/2357947691*t^6 + 142262971116616290360360960000/2357947691*t^5 - 23530271027395257484443648000/2357947691*t^4 - 64995732397895607222534144000/2357947691*t^3)/(t^10 - 4142/11*t^9 + 7629957/121*t^8 - 8206446312/1331*t^7 + 5682050136882/14641*t^6 - 2628567568326420/161051*t^5 + 813754184881274658/1771561*t^4 - 163163031525063652968/19487171*t^3 + 19431185297152056915213/214358881*t^2 - 1099349246891358321457518/2357947691*t + 904303412765472167650539/2357947691),
    (-805843923808602836433716828482041387417600000/4177248169415651*t^11 + 330466556219295694843070748382895149783449600000/4177248169415651*t^10 - 4511869205136927938289898451556156202549248000000/4177248169415651*t^9 + 12831626221377215408076540043158250019880960000000/4177248169415651*t^8 - 12621209594760747749272853342527540357496832000000/4177248169415651*t^7 + 4065845087742705548097826707107678435829350400000/4177248169415651*t^6 - 499032860706745331041074389321865507530342400000/4177248169415651*t^5)/(t^16 - 6896/11*t^15 + 22197240/121*t^14 - 44243010000/1331*t^13 + 61071546741660/14641*t^12 - 5622524670973392/14641*t^11 + 4316063205616350552/161051*t^10 - 2557791860541919438320/1771561*t^9 + 1180164435045716379244050/19487171*t^8 - 424136032026472436278448880/214358881*t^7 + 117841586324294209110877038168/2357947691*t^6 - 273770363348061698522875194582768/285311670611*t^5 + 42649705859662029010778048732227740/3138428376721*t^4 - 4652258721727486616672862576532309200/34522712143931*t^3 + 322716343915681344186181675525033319160/379749833583241*t^2 - 11496408502357436303038483927509694420464/4177248169415651*t + 8456492792599460357523500196677804068899/4177248169415651),
    27993600/121*t/(t^2 - 918/11*t + 210681/121),
    (-9447840000/1331*t^2 - 51018336000/1331*t)/(t^3 - 1377/11*t^2 + 632043/121*t - 96702579/1331),
    18575209267200/14641*t^2/(t^4 - 1836/11*t^3 + 1264086/121*t^2 - 386810316/1331*t + 44386483761/14641),
    (-149780038975488000/1127357*t^3 + 12694994583552000/1127357*t^2)/(t^5 - 2295/11*t^4 + 2106810/121*t^3 - 967025790/1331*t^2 + 221932418805/14641*t - 20373396046299/161051),
    (34271261097984000/161051*t^3 - 67706637778944000/161051*t^2)/(t^5 - 2295/11*t^4 + 2106810/121*t^3 - 967025790/1331*t^2 + 221932418805/14641*t - 20373396046299/161051),
    (-28633949596368764928000/19487171*t^4 - 16847578091810193408000/19487171*t^3)/(t^7 - 3213/11*t^6 + 4424301/121*t^5 - 3384590265/1331*t^4 + 1553526931635/14641*t^3 - 427841316972279/161051*t^2 + 65459721496758687/1771561*t - 4292287452430319619/19487171),
    (-18601693452288000000/1771561*t^4 + 120158123733319680000/12400927*t^3 + 33419573241200640000/1771561*t^2)/(t^6 - 2754/11*t^5 + 3160215/121*t^4 - 1934051580/1331*t^3 + 665797256415/14641*t^2 - 122240376277794/161051*t + 9351388785251241/1771561),
    (14651822206985011200000/136410197*t^4 - 23904040051099238400000/136410197*t^3 - 25630241939597721600000/136410197*t^2)/(t^6 - 2754/11*t^5 + 3160215/121*t^4 - 1934051580/1331*t^3 + 665797256415/14641*t^2 - 122240376277794/161051*t + 9351388785251241/1771561),
    (-17805491603106693120000000/1500512167*t^4 + 99703440660517355520000000/1500512167*t^3)/(t^7 - 3213/11*t^6 + 4424301/121*t^5 - 3384590265/1331*t^4 + 1553526931635/14641*t^3 - 427841316972279/161051*t^2 + 65459721496758687/1771561*t - 4292287452430319619/19487171),
    (170376983306934681600000/19487171*t^4 - 19743255576340070400000/1771561*t^3)/(t^7 - 3213/11*t^6 + 4424301/121*t^5 - 3384590265/1331*t^4 + 1553526931635/14641*t^3 - 427841316972279/161051*t^2 + 65459721496758687/1771561*t - 4292287452430319619/19487171),
    (-32799738607259363573760000/214358881*t^5 + 314207331412260107059200000/214358881*t^4 - 211521342942676978237440000/214358881*t^3)/(t^8 - 3672/11*t^7 + 5899068/121*t^6 - 5415344424/1331*t^5 + 3107053863270/14641*t^4 - 1140910178592744/161051*t^3 + 261838885987034748/1771561*t^2 - 34338299619442556952/19487171*t + 1970159940665516705121/214358881),
    (940209514651689167093760000/1500512167*t^5 - 2717893416716049926062080000/1500512167*t^4 + 888730803815602465013760000/1500512167*t^3)/(t^8 - 3672/11*t^7 + 5899068/121*t^6 - 5415344424/1331*t^5 + 3107053863270/14641*t^4 - 1140910178592744/161051*t^3 + 261838885987034748/1771561*t^2 - 34338299619442556952/19487171*t + 1970159940665516705121/214358881),
    (114192463790740319336996536320000/25937424601*t^7 - 53020476585849416437758689280000/25937424601*t^6 - 588574976566204579906395832320000/25937424601*t^5 + 598066853542105538459106017280000/25937424601*t^4)/(t^11 - 4601/11*t^10 + 9531135/121*t^9 - 11708596575/1331*t^8 + 9448808994090/14641*t^7 - 5236628581155258/161051*t^6 + 2020266698743101438/1771561*t^5 - 536676202385568720990/19487171*t^4 + 94323016767156273627525/214358881*t^3 - 10018263298284152445540285/2357947691*t^2 + 514548641863553663393156691/25937424601*t - 415075266459351724951597401/25937424601),
    (6972722728867219670197862400000/181561972207*t^6 - 46567155254908973616621158400000/181561972207*t^5 + 3937879195025562937589760000000/25937424601*t^4 + 11432285073558423770392166400000/25937424601*t^3)/(t^9 - 4131/11*t^8 + 7584516/121*t^7 - 8123016636/1331*t^6 + 5592696953886/14641*t^5 - 2567047901833674/161051*t^4 + 785516657961104244/1771561*t^3 - 154522348287491506284/19487171*t^2 + 17731439465989650346089/214358881*t - 904303412765472167650539/2357947691),
    (-17989560899771663646720000000/16505633837*t^5 - 80348140056252367503360000000/16505633837*t^4 - 92713834605103562096640000000/16505633837*t^3)/(t^8 - 3672/11*t^7 + 5899068/121*t^6 - 5415344424/1331*t^5 + 3107053863270/14641*t^4 - 1140910178592744/161051*t^3 + 261838885987034748/1771561*t^2 - 34338299619442556952/19487171*t + 1970159940665516705121/214358881),
    (-10282287504157908664320000000/2357947691*t^6 - 73154921806079778933964800000/2357947691*t^5 + 3999851536873203700649164800000/16505633837*t^4 - 87047855890038759673036800000/2357947691*t^3)/(t^9 - 4131/11*t^8 + 7584516/121*t^7 - 8123016636/1331*t^6 + 5592696953886/14641*t^5 - 2567047901833674/161051*t^4 + 785516657961104244/1771561*t^3 - 154522348287491506284/19487171*t^2 + 17731439465989650346089/214358881*t - 904303412765472167650539/2357947691),
    (13024230838600017641472000000/2357947691*t^6 - 51152406007627961597952000000/2357947691*t^5 - 31984074033670914048000000000/214358881*t^4 + 435239279450193798365184000000/2357947691*t^3)/(t^9 - 4131/11*t^8 + 7584516/121*t^7 - 8123016636/1331*t^6 + 5592696953886/14641*t^5 - 2567047901833674/161051*t^4 + 785516657961104244/1771561*t^3 - 154522348287491506284/19487171*t^2 + 17731439465989650346089/214358881*t - 904303412765472167650539/2357947691),
    (441489837865289881941280492093440000/1997181694277*t^8 - 3451152821306850215045156799774720000/1997181694277*t^7 + 10361162615563640830844123637350400000/1997181694277*t^6 - 11541070526653540600752754686689280000/1997181694277*t^5 + 624675947212581801127993807994880000/285311670611*t^4)/(t^12 - 460*t^11 + 1058454/11*t^10 - 1462126140/121*t^9 + 1347550438365/1331*t^8 - 870330173585688/14641*t^7 + 402170837953942260/161051*t^6 - 133088965191695661912/1771561*t^5 + 30968853969284756051085/19487171*t^4 - 4846593454037171094597660/214358881*t^3 + 464811954161452694172377046/2357947691*t^2 - 240743654546424000471926492580/285311670611*t + 190519547304842441752783207059/285311670611),
    (-26645055901462616907879913881600000/285311670611*t^8 - 397736254220307743643543797760000000/285311670611*t^7 + 1242366571673659120313533936435200000/285311670611*t^6 - 461602344376891251294732288000000000/285311670611*t^5 - 509016863805507929203585685913600000/285311670611*t^4)/(t^12 - 460*t^11 + 1058454/11*t^10 - 1462126140/121*t^9 + 1347550438365/1331*t^8 - 870330173585688/14641*t^7 + 402170837953942260/161051*t^6 - 133088965191695661912/1771561*t^5 + 30968853969284756051085/19487171*t^4 - 4846593454037171094597660/214358881*t^3 + 464811954161452694172377046/2357947691*t^2 - 240743654546424000471926492580/285311670611*t + 190519547304842441752783207059/285311670611),
    (6723048950243062541325434880000000/1997181694277*t^6 + 9184884451330735242876026880000000/285311670611*t^5 - 32312164106382387590631260160000000/285311670611*t^4)/(t^10 - 4590/11*t^9 + 9480645/121*t^8 - 11604309480/1331*t^7 + 9321161589810/14641*t^6 - 5134095803667348/161051*t^5 + 1963791644902760610/1771561*t^4 - 515074494291638354280/19487171*t^3 + 88657197329948251730445/214358881*t^2 - 9043034127654721676505390/2357947691*t + 415075266459351724951597401/25937424601),
    (-1655445179791265355974836224000000/181561972207*t^6 + 1351203797333122283483430912000000/181561972207*t^5 - 7672149309988330452553826304000000/181561972207*t^4)/(t^10 - 4590/11*t^9 + 9480645/121*t^8 - 11604309480/1331*t^7 + 9321161589810/14641*t^6 - 5134095803667348/161051*t^5 + 1963791644902760610/1771561*t^4 - 515074494291638354280/19487171*t^3 + 88657197329948251730445/214358881*t^2 - 9043034127654721676505390/2357947691*t + 415075266459351724951597401/25937424601),
    (99025934388820893723915820746355507200000/34522712143931*t^9 - 1245229493729842104186542764236315033600000/34522712143931*t^8 + 22686070536740451546996883870187520000000/285311670611*t^7 - 112621592573936313507630163272558182400000/3138428376721*t^6 - 577304660147952111934569808959583027200000/34522712143931*t^5)/(t^14 - 5978/11*t^13 + 16498755/121*t^12 - 230063652/11*t^11 + 2912778382059/1331*t^10 - 2415423673306098/14641*t^9 + 1485037211210780409/161051*t^8 - 685643825734620990120/1771561*t^7 + 237874278326235882965361/19487171*t^6 - 61315317673392210896775762/214358881*t^5 + 11438533868070457448611667811/2357947691*t^4 - 16166351478058830983414815574148/285311670611*t^3 + 1300295910355549664962745388177675/3138428376721*t^2 - 52643980272179453820245550208128762/34522712143931*t + 40138848745731510470918118846397179/34522712143931),
    (9517851250952789110987476172800000000/3138428376721*t^9 - 3002754080256226164263392804601856000000/21968998637047*t^8 + 7494604130549700955414303466323968000000/21968998637047*t^7 - 3510587063155576484315688515665920000000/21968998637047*t^6 - 5970277877260679709119616928186368000000/21968998637047*t^5 + 491255424302507226993077589639168000000/3138428376721*t^4)/(t^13 - 5519/11*t^12 + 1269594/11*t^11 - 1947956526/121*t^10 + 2018666336625/1331*t^9 - 1488855824795223/14641*t^8 + 801652387629773052/161051*t^7 - 317685379812555159252/1771561*t^6 + 92056688992273064868693/19487171*t^5 - 19061297425938874122045675/214358881*t^4 + 2689398349564514226592702986/2357947691*t^3 - 2587579211107598653348258197834/285311670611*t^2 + 112597052457161883075894875371869/3138428376721*t - 87448472212922680764527492040081/3138428376721),
    (3435704089157623298674630166839296000000/241658985007517*t^9 - 32075622166822775513198583764484096000000/241658985007517*t^8 + 108503017346437906628919387544879104000000/241658985007517*t^7 + 12155017095088907407587665529274368000000/241658985007517*t^6 - 34397503059512497559180009703211008000000/21968998637047*t^5 + 41049069323563074122195376210444288000000/34522712143931*t^4)/(t^13 - 5519/11*t^12 + 1269594/11*t^11 - 1947956526/121*t^10 + 2018666336625/1331*t^9 - 1488855824795223/14641*t^8 + 801652387629773052/161051*t^7 - 317685379812555159252/1771561*t^6 + 92056688992273064868693/19487171*t^5 - 19061297425938874122045675/214358881*t^4 + 2689398349564514226592702986/2357947691*t^3 - 2587579211107598653348258197834/285311670611*t^2 + 112597052457161883075894875371869/3138428376721*t - 87448472212922680764527492040081/3138428376721),
    (582372713388705834068775321734199273062400000/2658248835082687*t^10 - 9010300535910379644588076174932183928012800000/2658248835082687*t^9 + 43191557060876923363913817426678891990220800000/2658248835082687*t^8 - 8416903160213464422998506644179476335820800000/241658985007517*t^7 + 95984283910804313363521355900963831729356800000/2658248835082687*t^6 - 5715402371845494896849459550663036056371200000/379749833583241*t^5)/(t^15 - 6437/11*t^14 + 19242657/121*t^13 - 35410630437/1331*t^12 + 4074369761007/1331*t^11 - 3752388950671179/14641*t^10 + 2593716677258279391/161051*t^9 - 1367275905680369197851/1771561*t^8 + 552584794338426917430441/19487171*t^7 - 170499611425134481177876461/214358881*t^6 + 39582264680157482250231742569/2357947691*t^5 - 73919508977946570641455126351887/285311670611*t^4 + 8720651238784553086350145736711607/3138428376721*t^3 - 649479803125376750038145683381681587/34522712143931*t^2 + 24605114281133415918672806852841470727/379749833583241*t - 18423731574290763306151416550496305161/379749833583241),
    (140940263391074395218206939906943222716301312000000/45949729863572161*t^11 - 2599030564698320362462272653038911943568523264000000/45949729863572161*t^10 + 15767451507715639569656343493838275127053123584000000/45949729863572161*t^9 - 34024271079698808906946170720438317679183396864000000/45949729863572161*t^8 + 28109121018390638965981440222023625507921199104000000/45949729863572161*t^7 - 6553225596006800910145308721405949420368822272000000/45949729863572161*t^6)/(t^17 - 7355/11*t^16 + 25362504/121*t^15 - 54431543160/1331*t^14 + 81379088331660/14641*t^13 - 89879611335129252/161051*t^12 + 6896802029593137480/161051*t^11 - 4538864871919824341688/1771561*t^10 + 2354190899034457401432930/19487171*t^9 - 965831507712456254351467830/214358881*t^8 + 312520025024445057362685074088/2357947691*t^7 - 868752532699423160323693360293000/285311670611*t^6 + 168310302636422348632777763045718252/3138428376721*t^5 - 24228473711312357932619986944624841860/34522712143931*t^4 + 2458103097188597701239025598153363241960/379749833583241*t^3 - 159623210359655173284495872993499987914904/4177248169415651*t^2 + 5369872923300657327027422624890405583750865/45949729863572161*t - 3881530191803152304103286590275112067624641/45949729863572161)];
    RealField(10)!Max([Abs(invs_shim[i]-invs_norm[i]) : i in [1..#invs_shim]]);
    return Max([Abs(invs_shim[i]-invs_norm[i]) : i in [1..#invs_shim]]) lt epsilon;
end function;

function GetParam237(f)
  c3 := Transvectant(f, f, 8);
  c4 := Transvectant(f, f, 6);
  c5 := Transvectant(f, f, 4);
  c6 := Transvectant(f, f, 2);
  c7 := Transvectant(c4, f, 8);
  c9 := Transvectant(c5, f, 8);
  c12 := Transvectant(c6, f, 7);
  c22 := Transvectant(c12, f, 9);

  i4 := Transvectant(c7, c7, 2);
  i6 := Transvectant(c3*c9, f, 10);
  i7 := Transvectant(c9*c22, f, 10);
  param := 1-Evaluate(i4*(i6/i7)^3, [0,0])*3794886144/359165724775;
  
  //FIXME do over exact fields also
  m0 := MinimalPolynomial(Real(param), 15);
  m1, base_chg := Polredbest(m0);
  
  K<mu0> := NumberField(m1);
  param1 := K!base_chg;
  m2, base_chg := Polredabs(m1);
  L<mu> := NumberField(m2);
  
  return Evaluate(PolynomialRing(L)!Flat(param1), L!base_chg);
end function;

function GetParam239(Q, E)
  invs, wgt := InvariantsGenus4Curves(Q, E);
  a := invs[7]/invs[1];
  param := (918*a-3645)/(22*a+675);

  //FIXME do over exact fields also
  m0 := MinimalPolynomial(Real(param), 21);
  m1, base_chg := Polredbest(m0);
  
  K<mu0> := NumberField(m1);
  param1 := K!base_chg;
  m2, base_chg := Polredabs(m1);
  L<mu> := NumberField(m2);
  
  return Evaluate(PolynomialRing(L)!Flat(param1), L!base_chg);
end function;

function GetCurves237()
  R<x> := PolynomialRing(QQ);
  str := Read("Shimura/Shimura_237_param.m"); // assumes in Mumford-type directory
  str := Split(str, "\n");
  list_str := [Split(l, "|") : l in str];
  list_curves := [**];
  for l in list_str do
    K<mu> := NumberField(eval l[2]);
    Append(~list_curves, HyperellipticCurve(GetShimuraCurve237(eval l[3])));
  end for;
  return list_curves;
end function;

function GetCurves239()
  R<x> := PolynomialRing(QQ);
  str := Read("Shimura/Shimura_239_param.m"); // assumes in Mumford-type directory
  str := Split(str, "\n");
  list_str := [Split(l, "|") : l in str];
  list_curves := [**];
  for l in list_str do
    K<mu> := NumberField(eval l[2]);
    Q, E := GetShimuraCurve239(eval l[3]);
    Append(~list_curves, Curve(Proj(Parent(Q)), [Q, E]));
  end for;
  return list_curves;
end function;
